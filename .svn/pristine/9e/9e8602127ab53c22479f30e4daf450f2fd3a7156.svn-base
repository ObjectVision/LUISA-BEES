container JrcFactorDataTempl: IsTemplate = "True", IsHidden = "true"  //, Expr = "ReprojectedFactorData" 
{
	unit<WPoint> domain_grid;
	Container RunRegions;
	parameter<String> BaseYearCorineDataFileName;
		
	container TiffData: IsHidden = "True"
	{
		container LC1990
			:	Source = "JRC:LandCover"
			,	StorageName = "%sourceDataDir%/Luisetta/landuse/clc100_90_laea_lzw.tif"
			,	StorageReadOnly = "True"
			,	DialogData = "Geography/LambertEA"
		{
			attribute<Classifications/LU/Corine>    GridData(Geography/Lambert100mGrid);
			attribute<Classifications/LU/Corine>    ReadData (domain_grid);
			attribute<Classifications/LU/ModelType> ModelData(domain_grid): Expr = "Classifications/Lu/Corine/MT [ReadData]";
			attribute<Classifications/LU/ViewType>  ViewData (domain_grid): Expr = "Classifications/Lu/Corine/VT2[ReadData]";
		}
		container  LC2000
			:	Source = "JRC:LandCover"
			,	DialogData = "Geography/LambertEA"
			,	StorageName = "%sourceDataDir%/Luisetta/landuse/elc100_00_laea_lzw.tif"
			,	StorageReadOnly = "True"
		{
			attribute<Classifications/LU/Corine>    GridData(Geography/Lambert100mGrid);
			attribute<Classifications/LU/Corine>    ReadData (domain_grid);
			attribute<Classifications/LU/ModelType> ModelData(domain_grid): Expr = "Classifications/Lu/Corine/MT [ReadData]";
			attribute<Classifications/LU/ViewType>  ViewData (domain_grid): Expr = "Classifications/Lu/Corine/VT2[ReadData]";
		}
		unit<WPoint> CorineGrid
			:	DialogData = "Geography/LambertEA"
			,	Source = "JRC:LandCover"
			,	StorageName = "=BaseYearCorineDataFileName"
			,	StorageType = "gdal.grid"
			,	StorageReadOnly = "True"
		{
			attribute<Classifications/LU/Corine>    GridData;
			attribute<Classifications/LU/Corine>    CorineLandUse	(domain_grid);
			attribute<Classifications/LU/ModelType> ModelLandUse 	(domain_grid): Expr = "Classifications/LU/Corine/MT [CorineLandUse]";
			attribute<Classifications/LU/ViewType>  ViewLandUse  	(domain_grid): Expr = "Classifications/LU/Corine/VT2[CorineLandUse]";
		}
		unit<wpoint> AgeGrid: DialogData = "Geography/LambertEA" , StorageName = "%SourceDataDir%/Luisetta/landuse/age0.tif", StorageReadOnly = "True"
		{
			attribute<uint8> GridData;
			attribute<uint8> ReadData (domain_grid);
		}
		container AgeFromCLC
		{
			attribute<bool> Is_90_00(domain_grid): Expr = "LC1990/ViewData == LC2000/ViewData";
			attribute<bool> Is_00_06(domain_grid): Expr = "LC2000/ViewData == CorineGrid/ViewLandUse";
			
			attribute<uint8> AgeCLC  (domain_grid): Expr = "Is_00_06 ? Is_90_00 ? uint8(16) : uint8(6) : uint8(0)";
		}
		
		/*container Nuts2All: StorageName = "='%sourceDataDir%/Luisetta/nuts2_100m/Nuts2All.tif'", StorageReadOnly = "True"
		{
			attribute<Geography/Regions/Nuts2All> GridData(Geography/Lambert100mGrid): IsHidden = "True";
			attribute<Geography/Regions/Nuts2All> ReadData(domain_grid);
		}
		container X8: StorageName = "='%sourceDataDir%/Luisetta/succession/X8.tif'", StorageReadOnly = "True"
		{
			attribute<Int16> GridData(Geography/Lambert100mGrid): IsHidden = "True";
			attribute<Int16> ReadData(domain_grid);
		}
		container X9: StorageName = "='%sourceDataDir%/Luisetta/succession/X9.tif'", StorageReadOnly = "True"
		{
			attribute<Int16> GridData(Geography/Lambert100mGrid): IsHidden = "True";
			attribute<Int16> ReadData(domain_grid);
		}*/
		Unit<WPoint> Eu27_e: StorageName = "%SourceDataDir%/Luisetta/Elevation/eu27_e_ha.tif", StorageReadOnly = "True", DialogData = "Geography/LambertEA"
		{
			attribute<units/meter> Elevation (domain_grid): Expr="value(ReadData, units/meter)" ;
			attribute<Int16> GridData: IsHidden = "True";
			attribute<Int16> ReadData(domain_grid);
		}
		
		//to be phased out eventually with new calibration [JAN 28 2013] :
		container slope_euro: StorageName = "%SourceDataDir%/Luisetta/Elevation/slope_euro.tif", StorageReadOnly = "True"
		{
			attribute<Int8> GridData(Eu27_e): IsHidden = "True";
			attribute<Int8> ReadData(domain_grid);
		}	
		//to replace slope_euro eventually [Jan 28, 2013]
		Unit<WPoint> slope_continuous: StorageName = "%SourceDataDir%/Luisetta/Elevation/slope_deg_int16.tif", StorageReadOnly = "True", DialogData = "Geography/LambertEA"
		{
			attribute<units/degrees> slope (domain_grid): expr="value(ReadData, units/degrees)" ;
			attribute<Int16> GridData (Eu27_e): IsHidden = "True";
			attribute<Int16> ReadData(domain_grid);
		}				
		container sosl_euro: StorageName = "%SourceDataDir%/Luisetta/Elevation/sosl_euro.tif", StorageReadOnly = "True"
		{
			attribute<Int8> GridData(Eu27_e): IsHidden = "True";
			attribute<Int8> ReadData(domain_grid);
		}	
		Unit<WPoint> aspect_degrees: StorageName = "%SourceDataDir%/Luisetta/Elevation/aspect_100.tif", StorageReadOnly = "True", DialogData = "Geography/LambertEA"
		{
			attribute<units/degrees> aspect (domain_grid): expr="value(ReadData, units/degrees)" ;
			attribute<Int16> GridData (Eu27_e): IsHidden = "True";
			attribute<Int16> ReadData(domain_grid);
		}	
		
		unit<wpoint> DistanceToRoads: 
			StorageName       = "%SourceDataDir%/Luisetta/accessData/m5000dist_to_lvl2to6roads.tif"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<int16> GridData: IsHidden = "True";
			attribute<int16> ReadData(domain_grid);
		}
		unit<wpoint> DistanceToWater:
			StorageName 	  = "%SourceDataDir%/Luisetta/WaterDist/WaterDist.tif"
			, StorageReadOnly = "True" 
			, DialogData	  = "Geography/LambertEA"
		{
			attribute<float32> GridData: IsHidden = "True";
			attribute<float32> ReadData(domain_grid);
		}
		/*unit<wpoint> AccessToTowns: 
			StorageName       = "%SourceDataDir%/Luisetta/accessData/access_towns_etrs_sec.tif"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<Float32> GridData: IsHidden = "True";
			attribute<Float32> ReadData(domain_grid);
		}
		unit<wpoint> AccessToCities: 
			StorageName       = "%SourceDataDir%/Luisetta/accessData/access_cities_etrs_sec.tif"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<Float32> GridData: IsHidden = "True";
			attribute<Float32> ReadData(domain_grid);
		}*/
		unit<wpoint> SuitabilityCereals: 
			StorageName       = "%SourceDataDir%/Luisetta/suitability/suit_cere_corr.tif"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<uint8> GridData: IsHidden = "True";
			attribute<uint8> ReadData(domain_grid);
		}
		unit<wpoint> SuitabilityMaize: 
			StorageName       = "%SourceDataDir%/Luisetta/suitability/suit_maize_corr.tif"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<uint8> GridData: IsHidden = "True";
			attribute<uint8> ReadData(domain_grid);
		}
		unit<wpoint> SuitabilityRootcrops: 
			StorageName       = "%SourceDataDir%/Luisetta/suitability/suit_rootc_corr.tif"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<uint8> GridData: IsHidden = "True";
			attribute<uint8> ReadData(domain_grid);
		}
		unit<wpoint> SuitabilityCerealsPost2030: 
			//StorageName       = "%SourceDataDir%/Luisetta/suitability/suit_cere_corr_A1B_masked.tif"
			StorageName       = "%SourceDataDir%/Luisetta/suitability/CEREAL_A1B_change.tif"
			, StorageType = "gdal.grid"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<int16> GridData: IsHidden = "True";
			attribute<int16> ReadData(domain_grid);
		}		
		unit<wpoint> SuitabilityMaizePost2030: 
			//StorageName       = "%SourceDataDir%/Luisetta/suitability/suit_maize_corr_A1B_masked.tif"
			StorageName       = "%SourceDataDir%/Luisetta/suitability/MAIZE_A1B_change.tif"
			, StorageType = "gdal.grid"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<int16> GridData: IsHidden = "True";
			attribute<int16> ReadData(domain_grid);
		}		
		unit<wpoint> SuitabilityRootPost2030: 
			//StorageName       = "%SourceDataDir%/Luisetta/suitability/suit_rootc_corr_A1B_masked.tif"
			StorageName       = "%SourceDataDir%/Luisetta/suitability/ROOTC_A1B_change.tif"
			, StorageType = "gdal.grid"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<int16> GridData: IsHidden = "True";
			attribute<int16> ReadData(domain_grid);
		}		
		unit<wpoint> SuitabilityOtherArablePost2030: 
			//StorageName       = "%SourceDataDir%/Luisetta/suitability/suit_other_arable_corr_A1B_masked.tif"
			StorageName       = "%SourceDataDir%/Luisetta/suitability/OTHERARAB_A1B_change.tif"
			, StorageType = "gdal.grid"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<int16> GridData: IsHidden = "True";
			attribute<int16> ReadData(domain_grid);
		}				
		unit<wpoint> RiparianAreas:
			StorageName       = "%SourceDataDir%/Luisetta/SensitiveAreas/riparianAreas2012.tif"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<units/boolean> riparianAreas(domain_grid): expr = "value(ReadData, units/boolean)" ;
			attribute<uint8> GridData: IsHidden = "True";
			attribute<uint8> ReadData(domain_grid);
		}
		unit<WPoint> erosionRisk: StorageName = "%sourceDataDir%/Luisetta/SensitiveAreas/erosion_peseta.tif", StorageReadOnly = "True", DialogData = "Geography/LambertEA"
		{
			attribute<units/tonne_ha> erosionRisk(domain_grid): expr = "value(replace_value(ReadData, Int16(-32768), Int16(0 / 0)), units/tonne_ha)" ;
			attribute<Int16> GridData: IsHidden = "True";
			attribute<Int16> ReadData(domain_grid);
		}
		unit<wpoint> FloodRisk:
			StorageName       = "%SourceDataDir%/Luisetta/SensitiveAreas/FloodRisk_bin.tif"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<units/boolean> FloodRisk (domain_grid): Expr = "value(ReadData,units/boolean)";
			attribute<uint8> GridData: IsHidden = "True";
			attribute<uint8> ReadData(domain_grid);
		}
		unit<WPoint> CoastalZone: StorageName = "%sourceDataDir%/Luisetta/SensitiveAreas/CZ_100m.tif", StorageReadOnly = "True", DialogData = "Geography/LambertEA"
		{
			attribute<units/boolean> Coast (domain_grid): Expr = "value(replace_value(ReadData, Int8(-1), Int8(0 / 0)),units/boolean)";
			attribute<int8> GridData: IsHidden = "True";
			attribute<int8> ReadData(domain_grid);
		}	
		unit<wpoint> salinity2: StorageName = "%SourceDataDir%/Luisetta/NECR/salinity.tif", DialogData = "Geography/LambertEA"
		{
			attribute<uint8>	GridData: IsHidden = "True";
			attribute<uint8>	ReadData (domain_grid);
		}
			
		unit<WPoint> Natura2000: StorageName = "%sourceDataDir%/Luisetta/SensitiveAreas/n2k_v2011_bin.tif", StorageReadOnly = "True", DialogData = "Geography/LambertEA"
		{
			attribute<units/boolean> Natura2000 (domain_grid): Expr = "value(replace_value(ReadData, Int8(-1), Int8(0 / 0)),units/boolean)";
			attribute<int8> GridData: IsHidden = "True";
			attribute<int8> ReadData(domain_grid);
		}
		unit<WPoint> Natura2000Priority: StorageName = "%sourceDataDir%/Luisetta/SensitiveAreas/Natura2000_End2011_clean_union_Priority_bin.tif", StorageReadOnly = "True", DialogData = "Geography/LambertEA"
		{
			attribute<uint2> Natura2000Priority (domain_grid);
			attribute<uint2> GridData: IsHidden = "True";
			attribute<uint2> ReadData(domain_grid);
		}
		unit<WPoint> NDAs: StorageName = "%sourceDataDir%/Luisetta/SensitiveAreas/nda_100m_bin.tif", StorageReadOnly = "True", DialogData = "Geography/LambertEA"
		{
			attribute<units/boolean> NDA (domain_grid): Expr = "value(replace_value(ReadData, Int8(-1), Int8(0 / 0)),units/boolean)";
			attribute<int8> GridData: IsHidden = "True";
			attribute<int8> ReadData(domain_grid);
		}	
		unit<WPoint> NDA_Cat: StorageName = "%sourceDataDir%/Luisetta/SensitiveAreas/CDDA_v9_clean_unionCat.tif", StorageReadOnly = "True", DialogData = "Geography/LambertEA"
		{
			attribute<uint8> NDA_Cat (domain_grid);
			attribute<uint8> GridData: IsHidden = "True";
			attribute<uint8> ReadData(domain_grid);
		}
		unit<wpoint> HNV: 
			StorageName       = "%sourceDataDir%/Luisetta/SensitiveAreas/HNV/hnv06_100m_v5"
			, StorageType = "gdal.grid"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<units/boolean> IsHNV (domain_grid): Expr = "value(replace_value(ReadData, uint8(-1), uint8(0 / 0)),units/boolean)";
			attribute<uint8> GridData: IsHidden = "True";
			attribute<uint8> ReadData(domain_grid);
		}		
		unit<wpoint> SuitabilityForest: 
			StorageName       = "%sourceDataDir%/Luisetta/forests/Forest_EU28_100m_8bit.tif"
			, StorageType = "gdal.grid"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<uint8> GridData: IsHidden = "True";
			attribute<uint8> ReadData(domain_grid);
		}		
				
			//NECR DATA
			
		   unit<wpoint> SuitabilityMapNECR:
			//unit<wpoint> NECR_class: nrofrows = 6
			StorageName       = "%SourceDataDir%/Luisetta/NECR/SuitabilityMapEnergyCrop.tif"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<int8> GridData: IsHidden = "True";
			attribute<int8> ReadData(domain_grid);
			
			// This is in case we need to stablish different levels of suitability in the final map
			//attribute<string> Label: DialogType = "LabelText", [ 'zero', 'Very suitable', 'Suitable', 'Moderately suitable', 'Low suitable', 'Very low suitable'];
			//attribute<Float32> SuitValue: [ null, 0, 0.3, 0.3,0.2,0.1,0  ]; 										// I do not why
			//attribute<Bool>    Allowed:   [ false, true, true, true, true, true];	
		}
		
			//attribute<NECR_Class> SuitabilityMapNECR(domain_grid): StorageName = "%SourceDataDir%/Luisetta/NECR/SuitabilityMapEnergyCrop.tif"; 
		

		unit<wpoint> Peatlands:
			StorageName       = "%SourceDataDir%/Luisetta/NECR/Peatlands.tif"
			, StorageReadOnly = "True"
			, DialogData      = "Geography/LambertEA"
		{
			attribute<uint2> GridData: IsHidden = "True";
			attribute<uint2> ReadData(domain_grid);
			attribute<uint8>  IsPeatlands(domain_grid): Expr  = "ReadData == 1[uint2] ? uint8(15) : uint8(0)";
		}
				 	
		unit<uint8> salinityClass: nrofrows = 4
		{
			attribute<string> Label: DialogType = "LabelText", ['zero','Medium', 'Low', 'High' ];
			attribute<uint4>   FileValue: [0, 1, 2, 3];
			attribute<Float32> SuitValue: [null, 15, -15, 35 ]; 											
		}
			attribute<salinityClass> salinity(domain_grid): expr = "TiffData/salinity2/ReadData[salinityClass]";
			attribute<float32>			suitvalue (domain_grid): expr = "salinityClass/Suitvalue[TiffData/salinity2/ReadData[salinityClass]]";
			
						
		unit<uint16> ErodibilityClass: nrofrows= 7
		{
			attribute<string> Label: DialogType = "LabelText", ['zero', 'very low erosion', 'very weak', 'weak', 'Moderate','Strong','very strong' ];
			attribute<uint16>   FileValue: [0, 1, 2, 3, 4, 5, 6];
			attribute<Float32> SuitValue: [null, 0, 0, 0, 10, 20, 25];									
		}
			attribute<ErodibilityClass> Erodibility(domain_grid): StorageName = "%SourceDataDir%/Luisetta/NECR/erodibility.tif"; 	
			
				
		unit<wpoint> ContaminatedLands:
             StorageName       = "%SourceDataDir%/Luisetta/NECR/PotentialContaminatedLand.tif"
             , StorageReadOnly = "True"
             , DialogData      = "Geography/LambertEA"
          {
             attribute<uint8> GridData: IsHidden = "True";
             attribute<uint8> ReadData(domain_grid);
             attribute<uint8> IsContaminated(domain_grid): Expr  = "ReadData == 4[uint8] || ReadData == 5[uint8]  ? uint8(20) : uint8(0)";
           }					
	}
	
	container LocSpec_NECR
	{
		attribute<Float32> NECR_LocSpec(domain_grid): Expr = "(TiffData/salinityClass/SuitValue [TiffData/salinity]) + " 
		" (TiffData/ErodibilityClass/SuitValue [TiffData/Erodibility]) + "
		" Float32(TiffData/ContaminatedLands/IsContaminated)";
	}
	unit<wpoint> LocSpecSQ: 
		StorageName       = "%SourceDataDir%/Luisetta/locspecs/locspecSQ_int.tif"
		, StorageReadOnly = "True"
		, DialogData      = "Geography/LambertEA"
	{
		attribute<int8> GridData: IsHidden = "True";
		attribute<int8> ReadData(domain_grid);
	}
	unit<wpoint> SQLocSpec_nat01: 
		StorageName       = "%SourceDataDir%/Luisetta/locspecs/locSp_nat01.tif"
		, StorageReadOnly = "True"
		, DialogData      = "Geography/LambertEA"
	{
		attribute<int8> GridData: IsHidden = "True";
		attribute<int8> ReadData(domain_grid);
	}
	unit<wpoint> locspec_integration_agric: 
		StorageName       = "%SourceDataDir%/Luisetta/locspecs/locspec_integration_agric.tif"
		, StorageReadOnly = "True"
		, DialogData      = "Geography/LambertEA"
	{
		attribute<int8> GridData: IsHidden = "True";
		attribute<int8> ReadData(domain_grid);
	}
	unit<wpoint> locspec_integration_pastures: 
		StorageName       = "%SourceDataDir%/Luisetta/locspecs/locspec_integration_pastures.tif"
		, StorageReadOnly = "True"
		, DialogData      = "Geography/LambertEA"
	{
		attribute<int8> GridData: IsHidden = "True";
		attribute<int8> ReadData(domain_grid);
	}
	unit<wpoint> locspec_integration_sv: 
		StorageName       = "%SourceDataDir%/Luisetta/locspecs/locspec_integration_sv.tif"
		, StorageReadOnly = "True"
		, DialogData      = "Geography/LambertEA"
	{
		attribute<int8> GridData: IsHidden = "True";
		attribute<int8> ReadData(domain_grid);
	}
	unit<wpoint> locspec_integration_abandoned: 
		StorageName       = "%SourceDataDir%/Luisetta/locspecs/locspec_integration_abandoned.tif"
		, StorageReadOnly = "True"
		, DialogData      = "Geography/LambertEA"
	{
		attribute<int8> GridData: IsHidden = "True";
		attribute<int8> ReadData(domain_grid);
	}
	attribute<Geography/Lambert100mGrid> Lambert100mGridRel(domain_grid): Expr = "ID(domain_grid)[Geography/Lambert100mGrid]";
	
	attribute<uint8> age0 (domain_grid): Expr = "TiffData/AgeGrid/ReadData";
	
	attribute<Classifications/SlopeClass> Slope_100(domain_grid): // factor 65
		Expr = "value(TiffData/slope_euro/ReadData, Classifications/SlopeClass)", 
		url = "%SourceDataProjDir%/doc/Slope_100.pdf";
	attribute<float32>				water_km	  	(domain_grid): expr = "TiffData/DistanceToWater/ReadData / float32(1000)";
	attribute<Units/Boolean>        sosl_100 		(domain_grid): // factor 66
		Expr = "Bool(TiffData/sosl_euro/ReadData)", 
		url = "%SourceDataProjDir%/doc/Sosl_100.pdf"; 
	attribute</ShapeData/natura2000_v2011> natura2000_v2011_rel(domain_grid): FreeData = "False",
		Expr = "poly2grid(ShapeData/natura2000_v2011/Geometry, domain_grid, 1)", 
		url = "%SourceDataProjDir%/docs/natura2000_v2011.pdf";     //updated JAN 15 2013
	attribute<Units/Boolean> natura2000_v2011(domain_grid): // factor 67
		Expr = "IsDefined(natura2000_v2011_rel)", 
		url = "%SourceDataProjDir%/docs/natura2000_v2011.pdf";     //updated JAN 15 2013
	attribute<units/meter> Elevation_100(domain_grid): // factor 68
		Expr = "value(replace_value(TiffData/Eu27_e/ReadData, Int16(-32768), Int16(0 / 0)), units/meter)", 
		url = "%SourceDataProjDir%/doc/Elevation_100.pdf"; 
		
	attribute<units/degrees> slope100_cont(domain_grid): // factor 89
		Expr = "value(TiffData/slope_continuous/ReadData, units/degrees)";

	attribute<units/degrees> aspect100(domain_grid): // factor 91
		Expr = "value(TiffData/aspect_degrees/ReadData, units/degrees)";
		
	attribute</ShapeData/nda> nda_rel(domain_grid): FreeData = "False",
		Expr = "poly2grid(ShapeData/nda/Geometry, domain_grid, 1)"; 
	attribute<Units/Boolean> nda(domain_grid): FreeData = "False",
		Expr = "IsDefined(nda_rel)"; 		
	
	attribute<units/Boolean> IndustryMask(domain_grid) // factor 69
		:	StorageName = "%sourceDataDir%/Luisetta/Masks/IndustryMask2.tif"
		,	StorageType = "tif"
		,	StorageReadOnly = "True";
	attribute<units/Boolean> IndustryAllowed(domain_grid): Expr = "not(IndustryMask)"; // factor 69
			
// Added container for Integration locspec files 	
	Container ReferenceLocSpecs
	{
		attribute<int8> Urban                   (domain_grid): expr = "const(0, domain_grid, int8)";
		attribute<int8> Industrial              (domain_grid): expr = "Biodiversity/LOCSPECS/LocSpecsInd";

		attribute<int8> OtherArable             (domain_grid): expr = "CAP/LOCSPECS/LocSpecsAra";
		attribute<int8> PermanentCrops          (domain_grid): expr = "CAP/LOCSPECS/LocSpecsPC";
		attribute<int8> Pastures                (domain_grid): expr = "CAP/LOCSPECS/LocSpecsPast";
		
		attribute<int8> ForestsMature           (domain_grid): expr = "Biodiversity/LOCSPECS/LocSpecsFor";
		attribute<int8> TransWoodlandShrub      (domain_grid): expr = "const(0, domain_grid, int8)";
		
		attribute<int8> Cereals                 (domain_grid): expr = "CAP/LOCSPECS/LocSpecsAra";
		attribute<int8> Maize                   (domain_grid): expr = "CAP/LOCSPECS/LocSpecsAra";
		attribute<int8> Rootcrops               (domain_grid): expr = "CAP/LOCSPECS/LocSpecsAra";
		attribute<int8> NewEnergyCrops          (domain_grid): expr = "CAP/LOCSPECS/LocSpecNecr";
		
		attribute<int8> AbanArable              (domain_grid): expr = "LocSpecSQ/ReadData";
		attribute<int8> AbanPermanentCrops      (domain_grid): expr = "LocSpecSQ/ReadData";
		attribute<int8> AbanPastures            (domain_grid): expr = "LocSpecSQ/ReadData";
		attribute<int8> AbanUrban               (domain_grid): expr = "const(0, domain_grid, int8)";
		attribute<int8> AbanIndustry            (domain_grid): expr = "const(0, domain_grid, int8)";
		
		attribute<int8> SHVA                    (domain_grid): expr = "const(0, domain_grid, int8)";
		
		attribute<int8> ForestsYoung            (domain_grid): expr = "Biodiversity/LOCSPECS/LocSpecsFor";
	}

	// endogenous distance factors
	attribute<units/m_I16> DistRoads(domain_grid): // factor 76
		Expr = "TiffData/DistanceToRoads/ReadData - 100[units/m_I16] < 0[units/m_I16] ? value(0 / 0, units/m_I16) : TiffData/DistanceToRoads/ReadData  - 100[units/m_I16]"; 
	attribute<int32> TownAccess(domain_grid): // factor 73
		Expr = "round((float32(NetworkAnalysis/DistTown) >= Float32(0)) ? float32(NetworkAnalysis/DistTown) * float32(1000): Float32(0 / 0))"; 
	//attribute<Float32> AccessToCities(domain_grid): // factor 77
	//	Expr = "(TiffData/AccessToCities/ReadData >= Float32(0)) ? TiffData/AccessToCities/ReadData : Float32(0 / 0)"; 

	// Additional conditions based on CLC
	container rice {
				attribute<bool>  IsRiceFields (domain_grid): Expr = "TiffData/CorineGrid/CorineLandUse = uint8(14)";
				attribute<uint8> RiceFields   (domain_grid): Expr = "IsRiceFields ? uint8(100) : uint8(0)";
			   }	
	
	container permcrop {
			attribute<bool>  IsPermCrop (domain_grid): Expr = "TiffData/CorineGrid/CorineLandUse = uint8(15) || TiffData/CorineGrid/CorineLandUse = uint8(16) || TiffData/CorineGrid/CorineLandUse = uint8(17)";
			attribute<uint8> PermCrop   (domain_grid): Expr = "IsPermCrop ? uint8(0.1) : uint8(1)";
		   }		   
			   			
	// Suitability maps for agricultural commodities
	attribute<uint8> SuitCereals(domain_grid): // factor 78
		Expr = "TiffData/SuitabilityCereals/ReadData";
	attribute<Float32> SuitCerealsTF(domain_grid): // factor 92
		Expr = "Float32(SuitCereals) * Float32(-0.01)";	//default -0.05
		
	attribute<uint8> SuitMaize(domain_grid): // factor 79
		Expr = "TiffData/SuitabilityMaize/ReadData";
	attribute<Float32> SuitMaizeTF(domain_grid): // factor 93
		Expr = "Float32(SuitMaize) * Float32(-0.01)";	//default -0.05			

	attribute<uint8> SuitRoot(domain_grid): // factor 80
		Expr = "TiffData/SuitabilityRootCrops/ReadData";
	attribute<Float32> SuitRootTF(domain_grid): // factor 94
		Expr = "Float32(SuitRoot) * Float32(-0.01)";	//default -0.05	

	attribute<int16> SuitCerealsPost2030(domain_grid): // factor 104
		Expr = "TiffData/SuitabilityCerealsPost2030/ReadData";
	attribute<Float32> SuitCerealsPost2030TF(domain_grid): // factor 108
		Expr = "(Float32(SuitCerealsPost2030) * Float32(-0.008)) + Float32(SuitCerealsTF)";	

	attribute<int16> SuitMaizePost2030(domain_grid): // factor 105
		Expr = "TiffData/SuitabilityMaizePost2030/ReadData";
	attribute<Float32> SuitMaizePost2030TF(domain_grid): // factor 109
		Expr = "(Float32(SuitMaizePost2030) * Float32(-0.008)) + Float32(SuitMaizeTF)";
		
	attribute<int16> SuitRootPost2030(domain_grid): // factor 106
		Expr = "TiffData/SuitabilityRootPost2030/ReadData";
	attribute<Float32> SuitRootPost2030TF(domain_grid): // factor 110
		Expr = "(Float32(SuitRootPost2030) * Float32(-0.008)) + Float32(SuitRootTF)";			

	attribute<Float32> SuitOtherArableTF(domain_grid): // factor 96
		Expr = "((((Float32(SuitCereals)+ Float32(SuitMaize)+ Float32(SuitRoot)) /float32(3)) + float32(rice/RiceFields)) * Float32(-0.01))";	//default -0.05

	attribute<int16> SuitOtherArablePost2030(domain_grid): // factor 107
		Expr = "TiffData/SuitabilityOtherArablePost2030/ReadData";
	attribute<Float32> SuitOtherArablePost2030TF(domain_grid): // factor 111
		Expr = "(Float32(SuitOtherArablePost2030) * Float32(-0.008))  + Float32(SuitOtherArableTF)";

	// Suitability map for energy crops
	attribute<Int8> SuitNECR(domain_grid): // factor 90; 
		Expr = "IsNull(TiffData/SuitabilityMapNECR/ReadData) ? Int8(0): TiffData/SuitabilityMapNECR/ReadData";
	attribute<Float32> SuitNecrTF(domain_grid): // factor 95
		Expr = "or(TiffData/Natura2000/Natura2000, TiffData/NDAs/NDA, TiffData/HNV/IsHNV) ? Float32(1.5): Float32(SuitNECR) * Float32(-0.005)";	//default -0.05		
			
	// Mask for development ---> TO BE CLEANED UP!!!				
	attribute<Bool> AllowDevelopmentSQ(domain_grid): // factor 81
		Expr = "Not(natura2000_v2011)"; // not factor 67
	attribute<Float32> DevelopmentTaxSQ(domain_grid): // factor 82
		Expr = "Float32(natura2000_v2011) * Float32(1.3)";

	// Suitability map for forest	
	attribute<uint8> SuitFor(domain_grid): // factor 102
		Expr = "TiffData/SuitabilityForest/ReadData";
	attribute<Float32> SuitForTF(domain_grid): // factor 103
		Expr = "Float32(SuitFor) * float32(permcrop/PermCrop) * Float32(-0.05)";	//default -0.05		
		
							
	//attribute<float32> PotentialAccess	(domain_grid): expr = "DomesticAccess + ForeignAccess"; //factor 87
	//attribute<float32> DomesticAccess 	(domain_grid): expr = "NetworkAnalysis/dom_a"; //factor 97
	//attribute<float32> ForeignAccess 	(domain_grid): expr = "NetworkAnalysis/for_a"; //factor 98
	attribute<float32> Population2006 	(domain_grid): expr = "Population/Qi_2006"; //factor 88
	attribute<float32> ln_water			(domain_grid): expr = "log(float32(water_km)+ float32(0.01))"; // factor 101
	attribute<float32> ln_roads			(domain_grid): expr = "log(float32(DistRoads)+ float32(0.01))"; // factor 101
	
	container BurntAreas
	{
		unit<uint32> BurntAreas_shape: StorageName = "%SourceDataDir%/Luisetta/forests/BurntAreas2000-2012.dbf", StorageReadOnly = "True", DialogData = "Geometry", DialogType = "map"
		{
			attribute<Geography/LambertEA> 	Geometry (polygon): StorageName = "%SourceDataDir%/Luisetta/forests/BurntAreas2000-2012.shp", StorageReadOnly = "True";
			attribute<uint32>				YearSeason;
		}
		attribute<BurntAreas_shape> 	BurntGrid_id (domain_grid):	expr = "poly2grid(BurntAreas_shape/Geometry, domain_grid, 1)";
		attribute<uint32>				BurntInYear	 (domain_grid):	expr = "BurntAreas_shape/YearSeason[BurntGrid_id]";
	}
	#include <Biodiversity.dms>

	container SpatialFilters
	{
		attribute<bool> RiparianAreas     (domain_grid): Expr = "Bool(TiffData/RiparianAreas/ReadData)";
		attribute<bool> nat2k_buff500     (domain_grid): Expr = "potential(Float32(natura2000_v2011), /Parameters/FuncKernels/Cylinder500m/Matr) > Float32(0)";
		attribute<bool> nat2k_buff500_out (domain_grid): Expr = "nat2k_buff500 && ! natura2000_v2011";
		attribute<bool> nat2k_2010_mask   (domain_grid): Expr = "natura2000_v2011";
		attribute<bool> nda_buff500 	  (domain_grid): Expr = "potential(Float32(nda), /Parameters/FuncKernels/Cylinder500m/Matr) > Float32(0)";
	}
	container Population
	{
		container Qi_2006_Import_old: 
			StorageName = "%SourceDataDir%/Luisetta/Population/autogen_pop2006.tif", StoragereadOnly = "True", StorageType = "gdal.grid"
		{
			attribute<float32> GridData (Geography/Lambert100mGrid);
			attribute<float32> ReadData (domain_grid);
		}
	
		container Qi_2006_Import: 
			StorageName = "%SourceDataDir%/Luisetta/Population/autogen_pop2006_23mar16.tif", StoragereadOnly = "True", StorageType = "gdal.grid"
		{
			attribute<float32> GridData (Geography/Lambert100mGrid);
			attribute<float32> ReadData (domain_grid);
		}
		
		attribute<float32> popdif (domain_grid): expr = "Qi_2006_Import/ReadData - Qi_2006_Import_old/ReadData", StorageName = "%SourceDataDir%/Luisetta/Population/difmap_pop2006_22aug14.tif";
		
		attribute<units/NrResidents> Qi_2006(domain_grid): Expr = "Qi_2006_Import/ReadData[units/NrResidents]";
		parameter<float32> MoransI:					expr = "corr(Qi_2006_Import/ReadData, potential(Qi_2006_Import/ReadData, Parameters/FuncKernels/RooksNeighbours/Matr))";
//REMOVE		attribute<Geography/Regions/JrcRegion>	JrcRegion (domain_grid): expr = "TiffData/JrcRegion"; // used to read parameters for allocation
	}
}

